machine:
  environment:
    USE_DYNAMO_LOCAL: "True"

dependencies:
  cache_directories:
    - ~/.dynamo-2017-02-16

  override:
    - sudo pip install boto3
    - scripts/install-dynamodb-local

test:
  pre:
    - cd ~/.dynamo-2017-02-16 && java -Djava.library.path=. -jar DynamoDBLocal.jar -port 8001 -inMemory:
        background: true

  override:
    - ./scripts/lambda-test index
    - ./scripts/lambda-test submit

deployment:
  master:
    branch: master
    commands:
      - aws s3 sync html s3://gitshame-html
